import sqlite3
from pprint import pprint

def query_malware_detections(db_path='keylogger_detection.db'):
    """Query the malware detections from the database"""
    conn = sqlite3.connect(db_path)
    cursor = conn.cursor()
    
    try:
        # Get recent malware detections
        cursor.execute('''
            SELECT file_path, signature_name, detection_time, action_taken 
            FROM malware_detections 
            ORDER BY detection_time DESC 
            LIMIT 5
        ''')
        results = cursor.fetchall()
        
        if results:
            print("Recent malware detections:")
            pprint(results)
        else:
            print("No malware detections found in database")
            
    except sqlite3.Error as e:
        print(f"Database error: {str(e)}")
    finally:
        conn.close()

if __name__ == "__main__":
    query_malware_detections()
